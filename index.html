<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		
		<title>Ambience</title>
		
		<link rel="stylesheet" href="common.css">
		<link rel="stylesheet" href="generic.css" title="Generic">
		<link rel="alternate stylesheet" href="sci-fi.css" title="Sci-Fi">
		
		<script src="libraries/jquery.js"></script>
		<script src="libraries/jquery-ui.js"></script>
		<script src="libraries/knockout.js"></script>
		<script src="libraries/knockout-sortable.js"></script>
		<script src="libraries/knockwrap.js"></script>
		<script src="libraries/base64.js"></script>
		
		<script src="libraries/functions.js"></script>
		<script src="libraries/splitter.js"></script>
		<script src="libraries/animation.js"></script>
		<script src="libraries/preloader.js"></script>
		<script src="libraries/key.js"></script>
		
		<script src="source/ambience.js"></script>
		<script src="source/media/image.js"></script>
		<script src="source/media/sound-list.js"></script>
		<script src="source/media/sound.js"></script>
		<script src="source/media/background.js"></script>
		<script src="source/media/video.js"></script>
		<script src="source/media/text.js"></script>
		<script src="source/layer.js"></script>
		<script src="source/scene.js"></script>
		<script src="source/immersive/adventure.js"></script>
		<script src="source/immersive/immersive.js"></script>
	</head>
	<body>
		<div
			id="editor"
			class="editor"
			data-bind="
				event: {
					drop: readDroppedAdventure,
					dragover: handleDrag,
					keydown: stopPropagation,
					keypress: stopPropagation
				}">
			<div class="menu-bar">
				<ul class="action-list adventure">
					<li class="action load">
						<button data-bind="click: showAdventureSelector">Load Adventure</button>
						<input
							type="file"
							style="display: none"
							id="adventure-file"
							data-bind="event: { change: readSelectedAdventure }">
					</li>
					<li class="action save">
						<a
							target="_blank"
							data-bind="
								click: saveAdventure,
								attr: {
									href: adventureUrl,
									download: adventureFileName
								},
								event: { mouseover: serializeAdventure }">Save Adventure</a>
					</li>
					<li class="action media-folder">
						<label for="media-folder">Media folder</label>
						<input
							id="media-folder"
							type="text"
							data-bind="
								attr: { placeholder: pathPlaceholder },
								value: adventure.basePath,
								valueUpdate: 'afterkeydown'
							">
					</li>
				</ul>
				<ul class="action-list playback">
					<li class="action play"><button data-bind="click: playSelected">Play</button></li>
					<li class="action stop"><button data-bind="click: stopCurrent">Stop</button></li>
				</ul>
			</div>
			<!-- ko if: message -->
				<div class="message">
					<span class="text" data-bind="html: message"></span>
					<button data-bind="click: $root.clearMessage">Dismiss</button>
				</div>
			<!-- /ko -->
			<!-- ko with: adventure -->
				<div class="list-view">
					<ul data-bind="foreach: scenes, sortable: true">
						<li class="list-item" data-bind="click: $parent.select, css: { selected: isSelected }">
							<div class="preview" data-bind="
								style: {
									backgroundColor: background,
									backgroundImage: image.css,
									backgroundSize: image.size
								}
							">
								<div class="text outer">
									<div
										class="text inner"
										data-bind="
											text: text.string,
											style: {
												fontSize: text.smallPreviewSize,
												fontFamily: text.font,
												fontStyle: text.style,
												fontWeight: text.weight,
												color: text.color,
												textAlign: text.alignment,
												padding: text.previewPadding
											}
										"></div>
								</div>
							</div>
							<!-- ko if: name -->
								<span data-bind="text: name"></span>
							<!-- /ko -->
							<!-- ko ifnot: name -->
								<span class="note">Untitled</span>
							<!-- /ko -->
							<!-- ko if: key -->
								<span data-bind="text: key" class="key"></span>
							<!-- /ko -->
						</li>
					</ul>
					<div class="add-item">
						<button data-bind="click: add">Add Scene</button>
					</div>
				</div>
				<!-- ko with: current -->
				<div class="detail-view">
					<div class="selected-item">
						<ul class="action-list">
							<li class="action copy"><button data-bind="click: $parent.copySelected">Copy</button></li>
							<li class="action remove"><button data-bind="click: $parent.removeSelected">Remove</button></li>
						</ul>
						<div class="preview" data-bind="
							style: {
								backgroundColor: background,
								backgroundImage: image.css,
								backgroundSize: image.size
							}
						">
							<div class="text outer">
								<div
									class="text inner"
									data-bind="
										text: text.string,
										style: {
											fontSize: text.largePreviewSize,
											fontFamily: text.font,
											fontStyle: text.style,
											fontWeight: text.weight,
											color: text.color,
											textAlign: text.alignment,
											padding: text.previewPadding
										}
									"></div>
							</div>
						</div>
						<div class="options general">
							<table>
								<tr>
									<th><label for="name">Name</label></th>
									<td>
										<input
											id="name"
											type="text"
											placeholder="Untitled"
											data-bind="
												value: name,
												valueUpdate: 'afterkeydown'
											">
									</td>
								</tr>
								<tr>
									<th><label for="key">Hotkey</label></th>
									<td>
										<input
											id="key"
											type="text"
											data-bind="
												value: key,
												valueUpdate: 'afterkeydown',
												event: {
													keydown: $parent.bindSpecialKey,
													keypress: $parent.bindTextKey,
													keyup: $parent.stopKeyBinding
												}
											">
									</td>
								</tr>
							</table>
						</div>
						<div class="options specific">
							<ul class="tab-list">
								<li class="tab"><a href="#image-tab">Image</a></li>
								<li class="tab"><a href="#sound-tab">Sound</a></li>
								<li class="tab"><a href="#text-tab">Text</a></li>
								<li class="tab"><a href="#other-tab">Other</a></li>
							</ul>
							<div class="tab-content" id="image-tab">
								<table>
									<tr>
										<th>
											<label for="image-file">File</label>
										</th>
										<td>
											<input
												id="image-file"
												type="text"
												data-bind="
													value: image.path,
													valueUpdate: 'afterkeydown',
													attr: { placeholder: $root.pathPlaceholder }">
										</td>
									</tr>
									<tr>
										<th></th>
										<td>
											<ul class="modifier-list">
												<li class="modifier">
													<input id="size-contain" type="radio" value="contain" data-bind="checked: image.size">
													<label for="size-contain">Fit</label>
												</li>
												<li class="modifier">
													<input id="size-cover" type="radio" value="cover" data-bind="checked: image.size">
													<label for="size-cover">Fill</label>
												</li>
											</ul>
										</td>
									</tr>
								</table>
							</div>
							<div class="tab-content" id="sound-tab" data-bind="with: sound">
								<table>
									<tr>
										<td colspan="2">
											<ol data-bind="foreach: files, sortable: true" class="item-list">
												<li class="item">
													<div class="move">
														<img src="images/move.svg">
													</div>
													<div class="content">
														<input
															type="text"
															data-bind="
																value: path,
																valueUpdate: 'afterkeydown',
																attr: { placeholder: $root.pathPlaceholder }">
													</div>
													<div class="remove">
														<button data-bind="click: $parent.removeFile">Remove</button>
													</div>
												</li>
											</ol>
											<button data-bind="click: addFile">Add File</button>
										</td>
									</tr>
									<tr>
										<th><label>Playback</label></th>
										<td>
											<ul class="modifier-list">
												<li class="modifier">
													<input id="loop" type="checkbox" data-bind="checked: loop">
													<label for="loop">Loop</label>
												</li>
												<li class="modifier">
													<input id="shuffle" type="checkbox" data-bind="checked: shuffle">
													<label for="shuffle">Shuffle</label>
												</li>
											</ul>
										</td>
									</tr>
									<tr>
										<th><label for="crossover">Crossover</label></th>
										<td>
											<input id="crossover" type="number" min="0" value="0" data-bind="value: crossover">
											<span class="note">seconds</span>
										</td>
									</tr>
									<tr>
										<th>
											<label for="volume">Volume</label>
										</th>
										<td>
											<input
												id="volume"
												type="range"
												min="0"
												max="1"
												step="0.1"
												data-bind="value: volume">
										</td>
									</tr>
								</table>
							</div>
							<div class="tab-content" id="text-tab" data-bind="with: text">
								<table>
									<tr>
										<th><label for="text">Text</label></th>
										<td>
											<textarea
												id="text"
												rows="3"
												data-bind="
													value: string,
													valueUpdate: 'afterkeydown'
												"></textarea>
										</td>
									</tr>
									<tr>
										<th>
											<label for="font">Font</label>
										</th>
										<td>
											<input id="font" type="text" data-bind="value: font, valueUpdate: 'afterkeydown'">
										</td>
									</tr>
									<tr>
										<th></th>
										<td>
											<ul class="modifier-list">
												<li class="modifier">
													<input id="bold" type="checkbox" data-bind="checked: bold">
													<label for="bold"><b>Bold</b></label>
												</li>
												<li class="modifier">
													<input id="italic" type="checkbox" data-bind="checked: italic">
													<label for="italic"><i>Italic</i></label>
												</li>
											</ul>
										</td>
									<tr>
										<th><label for="font-size">Size</label></th>
										<td>
											<input id="font-size" type="range" min="3" max="30" step="0.5" data-bind="value: size">
										</td>
									</tr>
									<tr>
										<th><label for="font-color">Color</label></th>
										<td><input id="font-color" type="color" data-bind="value: color"></td>
									</tr>
									<tr>
										<th><label for="text-alignment">Align</label></th>
										<td>
											<select id="text-alignment" data-bind="value: alignment">
												<option value="left">Left</option>
												<option value="center">Center</option>
												<option value="right">Right</option>
											</select>
										</td>
									</tr>
									<tr>
										<th><label for="text-padding">Padding</label></th>
										<td>
											<input id="text-padding" type="range" min="0" max="40" step="2" data-bind="value: padding">
										</td>
									</tr>
								</table>
							</div>
							<div class="tab-content" id="other-tab">
								<table>
									<tr>
										<th><label for="background-color">Background</label></th>
										<td><input id="background-color" type="color" data-bind="value: background"></td>
									</tr>
									<tr>
										<th><label for="fade">Fade</label></th>
										<td>
											<input id="fade" type="number" min="0" value="0" data-bind="value: fade">
											<span class="note">seconds</span>
										</td>
									</tr>
									<tr>
										<th></th>
										<td>
											<ul class="modifier-list">
												<li class="modifier">
													<input id="fade-in" type="checkbox" data-bind="checked: fadeIn">
													<label for="fade-in">In</label>
												</li>
												<li class="modifier">
													<input id="fade-out" type="checkbox" data-bind="checked: fadeOut">
													<label for="fade-out">Out</label>
												</li>
											</ul>
										</td>
									</tr>
									<tr>
										<th><label for="layer">Layer</label></th>
										<td>
											<select id="layer" data-bind="value: layer">
												<option value="background">Background</option>
												<option value="foreground">Foreground</option>
											</select>
										</td>
									</tr>
									<tr>
										<th></th>
										<td>
											<ul class="modifier-list">
												<li class="modifier">
													<input id="mixin" type="checkbox" data-bind="checked: mixin">
													<label for="mixin">Mixin</label>
												</li>
											</ul>
										</td>
									</tr>
								</table>
							</div>
						</div>
					</div>
				</div>
				<!-- /ko -->
			<!-- /ko -->
		</div>
		<div id="theater" class="theater" data-bind="
			event: {
				mousemove: $root.scheduleHiddenInterface,
				mouseover: $root.scheduleHiddenInterface,
				mouseout: $root.showInterface
			}">
			<!-- ko if: instructionsAreVisible -->
			<div class="instructions outer">
				<div class="instructions inner">
					<p><em>Play your scenes here:</em></p>
					<p>If the scene has a name, type all or part of the name and press Enter.</p>
					<p>If the scene has a hotkey, press the hotkey.</p>
					<p>To stop the scene, press Enter.</p>
					<p><button type="button" data-bind="click: hideInstructions">Dismiss</button></p>
				</div>
			</div>
			<!-- /ko -->
			<div id="background" class="layer"></div>
			<div id="foreground" class="layer"></div>
			<form id="theater-form" class="action-form" data-bind="event: { submit: $root.playNamedScene }">
				<ul class="action-list" data-bind="visible: $root.interfaceIsVisible">
					<li class="action show" data-bind="visible: $root.editorIsHidden">
						<button type="button" data-bind="click: $root.showEditor">Show Editor</button>
					</li>
					<li class="action hide" data-bind="visible: $root.editorIsVisible">
						<button type="button" data-bind="click: $root.hideEditor">Hide Editor</button>
					</li>
					<li class="action command">
						<input type="text" data-bind="value: sceneName, valueUpdate: 'afterkeydown'">
					</li>
				</ul>
			</form>
		</div>
	</body>
</html>